<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Event builder &mdash; Processor for Analyzing XENON1T 4.4.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Processor for Analyzing XENON1T 4.4.1 documentation" href="index.html" />
    <link rel="next" title="Waveform simulator docs" href="simulator.html" />
    <link rel="prev" title="Plugins" href="plugin.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="event-builder">
<h1>Event builder<a class="headerlink" href="#event-builder" title="Permalink to this headline">¶</a></h1>
<div class="section" id="core-routines">
<h2>Core routines<a class="headerlink" href="#core-routines" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pax.plugins.io.MongoDB">
<span id="mongodb-interface"></span><h2>MongoDB interface<a class="headerlink" href="#module-pax.plugins.io.MongoDB" title="Permalink to this headline">¶</a></h2>
<p>Interfacing to MongoDB</p>
<p>MongoDB is used as a data backend within the DAQ.  For example, &#8216;kodiaq&#8217;, which
reads out the digitizers, will write data to MongoDB.  This data from kodiaq can
either be triggered or untriggered. In the case of untriggered, an event builder
must be run on the data and will result in triggered data.  Input and output
classes are provided for MongoDB access.  More information is in the docstrings.</p>
<dl class="class">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggered">
<em class="property">class </em><code class="descclassname">pax.plugins.io.MongoDB.</code><code class="descname">MongoDBReadUntriggered</code><span class="sig-paren">(</span><em>config_values</em>, <em>processor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReadUntriggered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggered" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pax.html#pax.plugin.InputPlugin" title="pax.plugin.InputPlugin"><code class="xref py py-class docutils literal"><span class="pre">pax.plugin.InputPlugin</span></code></a>, <a class="reference internal" href="pax.plugins.io.html#pax.plugins.io.MongoDB.MongoDBReader" title="pax.plugins.io.MongoDB.MongoDBReader"><code class="xref py py-class docutils literal"><span class="pre">pax.plugins.io.MongoDB.MongoDBReader</span></code></a></p>
<p>Read from MongoDB and build events
This will perform a sliding window trigger on the pulse midpoint times.
No PMT pulse data is read in this class to ensure speed.</p>
<dl class="attribute">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggered.do_output_check">
<code class="descname">do_output_check</code><em class="property"> = False</em><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggered.do_output_check" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggered.get_events">
<code class="descname">get_events</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReadUntriggered.get_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggered.get_events" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggered.last_event_number">
<code class="descname">last_event_number</code><em class="property"> = 0</em><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggered.last_event_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggered.sliding_window">
<code class="descname">sliding_window</code><span class="sig-paren">(</span><em>x</em>, <em>window=1000</em>, <em>multiplicity=3</em>, <em>left=-10</em>, <em>right=7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReadUntriggered.sliding_window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggered.sliding_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Sliding window cluster finder (with range extension)</p>
<p>x is a list of times.  A window will slide over the values in x and
this function will return all ranges with more than &#8216;multiplicity&#8217;
of pulses.
Also, left and right will be added to ranges, where left can be the
drift length.</p>
</dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggered.startup">
<code class="descname">startup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReadUntriggered.startup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggered.startup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggered.use_monary">
<code class="descname">use_monary</code><em class="property"> = True</em><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggered.use_monary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller">
<em class="property">class </em><code class="descclassname">pax.plugins.io.MongoDB.</code><code class="descname">MongoDBReadUntriggeredFiller</code><span class="sig-paren">(</span><em>config_values</em>, <em>processor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReadUntriggeredFiller"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pax.html#pax.plugin.TransformPlugin" title="pax.plugin.TransformPlugin"><code class="xref py py-class docutils literal"><span class="pre">pax.plugin.TransformPlugin</span></code></a>, <a class="reference internal" href="pax.plugins.io.html#pax.plugins.io.MongoDB.MongoDBReader" title="pax.plugins.io.MongoDB.MongoDBReader"><code class="xref py py-class docutils literal"><span class="pre">pax.plugins.io.MongoDB.MongoDBReader</span></code></a></p>
<p>Read pulse data from untriggered MongoDB into event ranges provided by trigger MongoDBReadUntriggered
This is a separate plugin, since reading the raw pulse data is the expensive operation we want to parallelize.</p>
<dl class="attribute">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller.do_input_check">
<code class="descname">do_input_check</code><em class="property"> = False</em><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller.do_input_check" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller.startup">
<code class="descname">startup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReadUntriggeredFiller.startup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller.startup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller.transform_event">
<code class="descname">transform_event</code><span class="sig-paren">(</span><em>event_proxy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReadUntriggeredFiller.transform_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReadUntriggeredFiller.transform_event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pax.plugins.io.MongoDB.MongoDBReader">
<em class="property">class </em><code class="descclassname">pax.plugins.io.MongoDB.</code><code class="descname">MongoDBReader</code><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReader.do_monary_query">
<code class="descname">do_monary_query</code><span class="sig-paren">(</span><em>query</em>, <em>fields</em>, <em>types</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReader.do_monary_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReader.do_monary_query" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReader.startup">
<code class="descname">startup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReader.startup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReader.startup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBReader.update_run_doc">
<code class="descname">update_run_doc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBReader.update_run_doc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReader.update_run_doc" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the internal run doc within this class</p>
<p>This is useful for example checking if a run has ended.</p>
</dd></dl>

<dl class="attribute">
<dt id="pax.plugins.io.MongoDB.MongoDBReader.use_monary">
<code class="descname">use_monary</code><em class="property"> = False</em><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBReader.use_monary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pax.plugins.io.MongoDB.MongoDBWriteTriggered">
<em class="property">class </em><code class="descclassname">pax.plugins.io.MongoDB.</code><code class="descname">MongoDBWriteTriggered</code><span class="sig-paren">(</span><em>config_values</em>, <em>processor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBWriteTriggered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBWriteTriggered" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pax.html#pax.plugin.OutputPlugin" title="pax.plugin.OutputPlugin"><code class="xref py py-class docutils literal"><span class="pre">pax.plugin.OutputPlugin</span></code></a></p>
<p>Write raw or processed events to MongoDB</p>
<p>These events are already triggered.  We first convert event class to a dict,
then pymongo converts that to BSON.  We have to convert the numpy arrays to
bytes because otherwise we get type errors since pymongo doesn&#8217;t know about
numpy.</p>
<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBWriteTriggered.startup">
<code class="descname">startup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBWriteTriggered.startup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBWriteTriggered.startup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pax.plugins.io.MongoDB.MongoDBWriteTriggered.write_event">
<code class="descname">write_event</code><span class="sig-paren">(</span><em>event_class</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#MongoDBWriteTriggered.write_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.MongoDBWriteTriggered.write_event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pax.plugins.io.MongoDB.pax_to_human_time">
<code class="descclassname">pax.plugins.io.MongoDB.</code><code class="descname">pax_to_human_time</code><span class="sig-paren">(</span><em>num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pax/plugins/io/MongoDB.html#pax_to_human_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pax.plugins.io.MongoDB.pax_to_human_time" title="Permalink to this definition">¶</a></dt>
<dd><p>num is in 1s of ns</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Event builder</a><ul>
<li><a class="reference internal" href="#core-routines">Core routines</a></li>
<li><a class="reference internal" href="#module-pax.plugins.io.MongoDB">MongoDB interface</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="plugin.html" title="previous chapter">Plugins</a></li>
      <li>Next: <a href="simulator.html" title="next chapter">Waveform simulator docs</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/eventbuilder.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Christopher Tunnell.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/eventbuilder.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>