##
# XENON100-specific configuration settings
##


# This is just for setting up pax
[pax]
parent_configuration = "_base"

dsp = [
       'BuildWaveforms.BuildWaveforms',
       'Filtering.Filtering',   # Just for fun, looks nice in plot

       'SmallPeakfinder.FindSmallPeaks',

       'SmallPeakProcessing.ClusterSmallPeaks',
       'SmallPeakProcessing.AdHocClassification',

       ]


[Filtering.Filtering]
simulate_Xerawdp_convolution_bug = False
filters = (
        {'name' : 'tpc_s2',  'source' : 'tpc',  'impulse_response' : (
            0.005452,  0.009142,  0.013074,  0.017179,  0.021381,  0.025597,  0.029746,  0.033740,  0.037499,
            0.040941,  0.043992,  0.046586,  0.048666,  0.050185,  0.051111,  0.051422,  0.051111,  0.050185,
            0.048666,  0.046586,  0.043992,  0.040941,  0.037499,  0.033740,  0.029746,  0.025597,  0.021381,
            0.017179,  0.013074,  0.009142,  0.005452
        )},
        {'name' : 'tpc_s1',  'source' : 'tpc',  'impulse_response' : (
            0.05, 0.1, 0.2, 0.3, 0.2, 0.1, 0.05
        )},
        {'name' : 'veto_s1', 'source' : 'veto', 'impulse_response' : (
            0.05, 0.1, 0.2, 0.3, 0.2, 0.1, 0.05
        )},
    )



[SmallPeakfinder.FindSmallPeaks]
# Minimum sigma's above noise level for an excess in a channel to be regarded as a peak:
peak_minimum_sigma = 5

# Initial guess for the noise_sigma; will be refined during peakfinding.
# If set too high, peaks may not get found; if set too low, spurious peaks may be found in noise.
noise_sigma_guess = 0.05 #pe/bin#

# Stop small peakfinding after a large peak.
# This will increase performance, but you'll lose small S2s in the photo-ionization tail of large events.
# Setting this to 10000 on Ambe 120402's first 100 events more than doubles FindSmallPeaks' speed
give_up_after_peak_of_size = 100000

# Filter each occurrence waveform with a simple impulse response convolution
# It's your job to check this is normalized!
# Based on looking at a few 100 occurences, it looks like a simple sliding window [0.5, 0.5]
# may be slightly better than e.g. [0.8, 0.2]. While [0.8, 0.2] looks more like our peaks, it
# doesn't suppress fluctuating noise as well.
# TODO: This could be studied with the waveform simulator, or looking at lots of diagnostic plots.
filter_to_use = [0.5, 0.5]

# FindSmallPeaks knows how many 'noise occurrences' (occurrences which contain no peaks) there are in each channel
# If a channel includes more than the below number of noise occurrences, it is marked as bad in this event
# This will lead IdentifySmallPeaks to not conside peaks from these channels,
# and cause them to appear grayed out in PlotChannelWaveforms2d)
maximum_noise_occurrences_per_channel = 4

# Output peakfinder diagnostic plots to directory
# Warning: this will produce LOTS of plots, processing will be EXTREMELY SLOW
# That's why they're called diagnostic plots...
make_diagnostic_plots = 'never'                 #'always', 'never' (default), or 'no peaks'
make_diagnostic_plots_in = 'diagnostic_plots'

# The algorithm refines its noise_sigma by excluding all samples part of a peak.
# Then peakfinding is repeated, then noise_sigma finding, etc.
# In principle this process is self-stabilizing, so it rarely takes more than 3 or 4 passes.
# In very rare occasions we never settle on peaks and the noise_sigma remains oscillatory.
# To protect against infinite loops, if more than the below number of passes have been done,
#  no new pass is started, and a loud warning ensues.
# Don't set this too low, or you'll be flooded with warnings.
max_noise_detection_passes = 20

# Method used to compute the noise level
# can be std (for standard deviation) or mad (for median absolute deviation)
# Looks like mad usually gives about 1/3 lower noise level
# Maybe mad is stabler though.. have to test this
noise_determination_method = 'std'


[SmallPeakProcessing.ClusterSmallPeaks]
# If spe peaks are separated by less than this, they will be clustered together
cluster_separation_time = 0.8 * us

# FindSmallPeaks knows how many 'lone pulses' there are in each channel
# If a channel includes more than the below number of lone pulses, it is marked as bad in this event
# This will lead IdentifySmallPeaks to not conside peaks from these channels,
# and cause them to appear grayed out in PlotChannelWaveforms2d)
maximum_lone_pulses_per_channel = 2

exclude_bad_channels = True



# Global settings, passed to every plugin
[DEFAULT]
tpc_name = "XENON100"

# Detector specification
# PlotChannelWaveform2D expects the detector names' lexical order to be the same as the channel order
channels_in_detector = {
    'tpc':   list(range(0,   178+1)),
    'veto':  list(range(179, 242+1)),
    }
n_channels = 242 + 1   # +1 for the fake pmt 0

# PMT numbers for tpc, specified as lists
# Remember python range does not include endpoint!
# PMT 0 does not exist, its gain is set to 0 later
channels_top = list(range(0,  98 + 1))
channels_bottom = list(range(99, 178 + 1))

# PMT locations taken from Marc Schumann's pmtpattern code.  Agrees also
# with the top PMT locations used by xerawdp.
# Note: don't forget the units...
pmt_locations =   [ {'x' : 0 * mm, 'y' : 0 * mm},
                    {'x' : -166.84 * mm, 'y' : 0.00 * mm},	{'x' : -163.19 * mm, 'y' : 34.69 * mm},
                    {'x' : -152.42 * mm, 'y' : 67.86 * mm},	{'x' : -134.98 * mm, 'y' : 98.07 * mm},
                    {'x' : -111.64 * mm, 'y' : 123.99 * mm},	{'x' : -83.42 * mm, 'y' : 144.49 * mm},
                    {'x' : -51.56 * mm, 'y' : 158.67 * mm},	{'x' : -17.44 * mm, 'y' : 165.93 * mm},
                    {'x' : 17.44 * mm, 'y' : 165.93 * mm},	{'x' : 51.56 * mm, 'y' : 158.67 * mm},
                    {'x' : 83.42 * mm, 'y' : 144.49 * mm},	{'x' : 111.64 * mm, 'y' : 123.99 * mm},
                    {'x' : 134.98 * mm, 'y' : 98.07 * mm},	{'x' : 152.42 * mm, 'y' : 67.86 * mm},
                    {'x' : 163.19 * mm, 'y' : 34.69 * mm},	{'x' : 166.84 * mm, 'y' : 0.00 * mm},
                    {'x' : 163.19 * mm, 'y' : -34.69 * mm},	{'x' : 152.42 * mm, 'y' : -67.86 * mm},
                    {'x' : 134.98 * mm, 'y' : -98.07 * mm},	{'x' : 111.64 * mm, 'y' : -123.99 * mm},
                    {'x' : 83.42 * mm, 'y' : -144.49 * mm},	{'x' : 51.56 * mm, 'y' : -158.67 * mm},
                    {'x' : 17.44 * mm, 'y' : -165.93 * mm},	{'x' : -17.44 * mm, 'y' : -165.93 * mm},
                    {'x' : -51.56 * mm, 'y' : -158.67 * mm},	{'x' : -83.42 * mm, 'y' : -144.49 * mm},
                    {'x' : -111.64 * mm, 'y' : -123.99 * mm},	{'x' : -134.98 * mm, 'y' : -98.07 * mm},
                    {'x' : -152.42 * mm, 'y' : -67.86 * mm},	{'x' : -163.19 * mm, 'y' : -34.69 * mm},
                    {'x' : -136.53 * mm, 'y' : 0.00 * mm},	{'x' : -131.88 * mm, 'y' : 35.34 * mm},
                    {'x' : -118.24 * mm, 'y' : 68.27 * mm},	{'x' : -96.54 * mm, 'y' : 96.54 * mm},
                    {'x' : -68.27 * mm, 'y' : 118.24 * mm},	{'x' : -35.34 * mm, 'y' : 131.88 * mm},
                    {'x' : 0.00 * mm, 'y' : 136.53 * mm},	{'x' : 35.34 * mm, 'y' : 131.88 * mm},
                    {'x' : 68.27 * mm, 'y' : 118.24 * mm},	{'x' : 96.54 * mm, 'y' : 96.54 * mm},
                    {'x' : 118.24 * mm, 'y' : 68.27 * mm},	{'x' : 131.88 * mm, 'y' : 35.34 * mm},
                    {'x' : 136.53 * mm, 'y' : 0.00 * mm},	{'x' : 131.88 * mm, 'y' : -35.34 * mm},
                    {'x' : 118.24 * mm, 'y' : -68.27 * mm},	{'x' : 96.54 * mm, 'y' : -96.54 * mm},
                    {'x' : 68.27 * mm, 'y' : -118.24 * mm},	{'x' : 35.34 * mm, 'y' : -131.88 * mm},
                    {'x' : 0.00 * mm, 'y' : -136.53 * mm},	{'x' : -35.34 * mm, 'y' : -131.88 * mm},
                    {'x' : -68.27 * mm, 'y' : -118.24 * mm},	{'x' : -96.54 * mm, 'y' : -96.54 * mm},
                    {'x' : -118.24 * mm, 'y' : -68.27 * mm},	{'x' : -131.88 * mm, 'y' : -35.34 * mm},
                    {'x' : -106.20 * mm, 'y' : 0.00 * mm},	{'x' : -101.00 * mm, 'y' : 32.82 * mm},
                    {'x' : -85.92 * mm, 'y' : 62.42 * mm},	{'x' : -62.42 * mm, 'y' : 85.92 * mm},
                    {'x' : -32.82 * mm, 'y' : 101.00 * mm},	{'x' : 0.00 * mm, 'y' : 106.20 * mm},
                    {'x' : 32.82 * mm, 'y' : 101.00 * mm},	{'x' : 62.42 * mm, 'y' : 85.92 * mm},
                    {'x' : 85.92 * mm, 'y' : 62.42 * mm},	{'x' : 101.00 * mm, 'y' : 32.82 * mm},
                    {'x' : 106.20 * mm, 'y' : 0.00 * mm},	{'x' : 101.00 * mm, 'y' : -32.82 * mm},
                    {'x' : 85.92 * mm, 'y' : -62.42 * mm},	{'x' : 62.42 * mm, 'y' : -85.92 * mm},
                    {'x' : 32.82 * mm, 'y' : -101.00 * mm},	{'x' : 0.00 * mm, 'y' : -106.20 * mm},
                    {'x' : -32.82 * mm, 'y' : -101.00 * mm},	{'x' : -62.42 * mm, 'y' : -85.92 * mm},
                    {'x' : -85.92 * mm, 'y' : -62.42 * mm},	{'x' : -101.00 * mm, 'y' : -32.82 * mm},
                    {'x' : -75.87 * mm, 'y' : 0.00 * mm},	{'x' : -68.76 * mm, 'y' : 32.06 * mm},
                    {'x' : -47.75 * mm, 'y' : 58.96 * mm},	{'x' : -17.07 * mm, 'y' : 73.93 * mm},
                    {'x' : 15.77 * mm, 'y' : 74.21 * mm},	{'x' : 46.71 * mm, 'y' : 59.79 * mm},
                    {'x' : 68.19 * mm, 'y' : 33.26 * mm},	{'x' : 75.87 * mm, 'y' : 0.00 * mm},
                    {'x' : 68.76 * mm, 'y' : -32.06 * mm},	{'x' : 47.75 * mm, 'y' : -58.96 * mm},
                    {'x' : 17.07 * mm, 'y' : -73.93 * mm},	{'x' : -15.77 * mm, 'y' : -74.21 * mm},
                    {'x' : -46.71 * mm, 'y' : -59.79 * mm},	{'x' : -68.19 * mm, 'y' : -33.26 * mm},
                    {'x' : -45.00 * mm, 'y' : 0.00 * mm},	{'x' : -30.00 * mm, 'y' : 30.00 * mm},
                    {'x' : 0.00 * mm, 'y' : 45.00 * mm},	{'x' : 30.00 * mm, 'y' : 30.00 * mm},
                    {'x' : 45.00 * mm, 'y' : 0.00 * mm},	{'x' : 30.00 * mm, 'y' : -30.00 * mm},
                    {'x' : 0.00 * mm, 'y' : -45.00 * mm},	{'x' : -30.00 * mm, 'y' : -30.00 * mm},
                    {'x' : -15.00 * mm, 'y' : 0.00 * mm},	{'x' : 15.00 * mm, 'y' : 0.00 * mm},
                    {'x' : 41.15 * mm, 'y' : 123.44 * mm},	{'x' : 13.71 * mm, 'y' : 123.44 * mm},
                    {'x' : -13.71 * mm, 'y' : 123.44 * mm},	{'x' : -41.15 * mm, 'y' : 123.44 * mm},
                    {'x' : 82.29 * mm, 'y' : 96.00 * mm},	{'x' : 54.86 * mm, 'y' : 96.00 * mm},
                    {'x' : 27.43 * mm, 'y' : 96.00 * mm},	{'x' : 0.00 * mm, 'y' : 96.00 * mm},
                    {'x' : -27.43 * mm, 'y' : 96.00 * mm},	{'x' : -54.86 * mm, 'y' : 96.00 * mm},
                    {'x' : -82.29 * mm, 'y' : 96.00 * mm},	{'x' : 109.72 * mm, 'y' : 68.58 * mm},
                    {'x' : 82.29 * mm, 'y' : 68.58 * mm},	{'x' : 54.86 * mm, 'y' : 68.58 * mm},
                    {'x' : 27.43 * mm, 'y' : 68.58 * mm},	{'x' : 0.00 * mm, 'y' : 68.58 * mm},
                    {'x' : -27.43 * mm, 'y' : 68.58 * mm},	{'x' : -54.86 * mm, 'y' : 68.58 * mm},
                    {'x' : -82.29 * mm, 'y' : 68.58 * mm},	{'x' : -109.72 * mm, 'y' : 68.58 * mm},
                    {'x' : 123.44 * mm, 'y' : 41.15 * mm},	{'x' : 96.00 * mm, 'y' : 41.15 * mm},
                    {'x' : 68.58 * mm, 'y' : 41.15 * mm},	{'x' : 41.15 * mm, 'y' : 41.15 * mm},
                    {'x' : 13.71 * mm, 'y' : 41.15 * mm},	{'x' : -13.71 * mm, 'y' : 41.15 * mm},
                    {'x' : -41.15 * mm, 'y' : 41.15 * mm},	{'x' : -68.58 * mm, 'y' : 41.15 * mm},
                    {'x' : -96.00 * mm, 'y' : 41.15 * mm},	{'x' : -123.44 * mm, 'y' : 41.15 * mm},
                    {'x' : 123.44 * mm, 'y' : 13.71 * mm},	{'x' : 96.00 * mm, 'y' : 13.71 * mm},
                    {'x' : 68.58 * mm, 'y' : 13.71 * mm},	{'x' : 41.15 * mm, 'y' : 13.71 * mm},
                    {'x' : 13.71 * mm, 'y' : 13.71 * mm},	{'x' : -13.71 * mm, 'y' : 13.71 * mm},
                    {'x' : -41.15 * mm, 'y' : 13.71 * mm},	{'x' : -68.58 * mm, 'y' : 13.71 * mm},
                    {'x' : -96.00 * mm, 'y' : 13.71 * mm},	{'x' : -123.44 * mm, 'y' : 13.71 * mm},
                    {'x' : 123.44 * mm, 'y' : -13.71 * mm},	{'x' : 96.00 * mm, 'y' : -13.71 * mm},
                    {'x' : 68.58 * mm, 'y' : -13.71 * mm},	{'x' : 41.15 * mm, 'y' : -13.71 * mm},
                    {'x' : 13.71 * mm, 'y' : -13.71 * mm},	{'x' : -13.71 * mm, 'y' : -13.71 * mm},
                    {'x' : -41.15 * mm, 'y' : -13.71 * mm},	{'x' : -68.58 * mm, 'y' : -13.71 * mm},
                    {'x' : -96.00 * mm, 'y' : -13.71 * mm},	{'x' : -123.44 * mm, 'y' : -13.71 * mm},
                    {'x' : 123.44 * mm, 'y' : -41.15 * mm},	{'x' : 96.00 * mm, 'y' : -41.15 * mm},
                    {'x' : 68.58 * mm, 'y' : -41.15 * mm},	{'x' : 41.15 * mm, 'y' : -41.15 * mm},
                    {'x' : 13.71 * mm, 'y' : -41.15 * mm},	{'x' : -13.71 * mm, 'y' : -41.15 * mm},
                    {'x' : -41.15 * mm, 'y' : -41.15 * mm},	{'x' : -68.58 * mm, 'y' : -41.15 * mm},
                    {'x' : -96.00 * mm, 'y' : -41.15 * mm},	{'x' : -123.44 * mm, 'y' : -41.15 * mm},
                    {'x' : 109.72 * mm, 'y' : -68.58 * mm},	{'x' : 82.29 * mm, 'y' : -68.58 * mm},
                    {'x' : 54.86 * mm, 'y' : -68.58 * mm},	{'x' : 27.43 * mm, 'y' : -68.58 * mm},
                    {'x' : 0.00 * mm, 'y' : -68.58 * mm},	{'x' : -27.43 * mm, 'y' : -68.58 * mm},
                    {'x' : -54.86 * mm, 'y' : -68.58 * mm},	{'x' : -82.29 * mm, 'y' : -68.58 * mm},
                    {'x' : -109.72 * mm, 'y' : -68.58 * mm},	{'x' : 82.29 * mm, 'y' : -96.00 * mm},
                    {'x' : 54.86 * mm, 'y' : -96.00 * mm},	{'x' : 27.43 * mm, 'y' : -96.00 * mm},
                    {'x' : 0.00 * mm, 'y' : -96.00 * mm},	{'x' : -27.43 * mm, 'y' : -96.00 * mm},
                    {'x' : -54.86 * mm, 'y' : -96.00 * mm},	{'x' : -82.29 * mm, 'y' : -96.00 * mm},
                    {'x' : 41.15 * mm, 'y' : -123.44 * mm},	{'x' : 13.71 * mm, 'y' : -123.44 * mm},
                    {'x' : -13.71 * mm, 'y' : -123.44 * mm},	{'x' : -41.15 * mm, 'y' : -123.44 * mm},
                    {'x' : -197.15 * mm, 'y' : 0.00 * mm},	{'x' : -193.53 * mm, 'y' : 37.62 * mm},
                    {'x' : -182.79 * mm, 'y' : 73.85 * mm},	{'x' : -165.34 * mm, 'y' : 107.38 * mm},
                    {'x' : -139.41 * mm, 'y' : 139.41 * mm},	{'x' : -110.25 * mm, 'y' : 163.44 * mm},
                    {'x' : -77.03 * mm, 'y' : 181.48 * mm},	{'x' : -40.99 * mm, 'y' : 192.84 * mm},
                    {'x' : 0.00 * mm, 'y' : 197.15 * mm},	{'x' : 37.62 * mm, 'y' : 193.53 * mm},
                    {'x' : 73.85 * mm, 'y' : 182.79 * mm},	{'x' : 107.38 * mm, 'y' : 165.34 * mm},
                    {'x' : 139.41 * mm, 'y' : 139.41 * mm},	{'x' : 163.44 * mm, 'y' : 110.25 * mm},
                    {'x' : 181.48 * mm, 'y' : 77.03 * mm},	{'x' : 192.84 * mm, 'y' : 40.99 * mm},
                    {'x' : 197.15 * mm, 'y' : 0.00 * mm},	{'x' : 193.53 * mm, 'y' : -37.62 * mm},
                    {'x' : 182.79 * mm, 'y' : -73.85 * mm},	{'x' : 165.34 * mm, 'y' : -107.38 * mm},
                    {'x' : 139.41 * mm, 'y' : -139.41 * mm},	{'x' : 110.25 * mm, 'y' : -163.44 * mm},
                    {'x' : 77.03 * mm, 'y' : -181.48 * mm},	{'x' : 40.99 * mm, 'y' : -192.84 * mm},
                    {'x' : 0.00 * mm, 'y' : -197.15 * mm},	{'x' : -37.62 * mm, 'y' : -193.53 * mm},
                    {'x' : -73.85 * mm, 'y' : -182.79 * mm},	{'x' : -107.38 * mm, 'y' : -165.34 * mm},
                    {'x' : -139.41 * mm, 'y' : -139.41 * mm},	{'x' : -163.44 * mm, 'y' : -110.25 * mm},
                    {'x' : -181.48 * mm, 'y' : -77.03 * mm},	{'x' : -192.84 * mm, 'y' : -40.99 * mm},
                    {'x' : 197.15 * mm, 'y' : 0.00 * mm},	{'x' : 193.53 * mm, 'y' : 37.62 * mm},
                    {'x' : 182.79 * mm, 'y' : 73.85 * mm},	{'x' : 165.34 * mm, 'y' : 107.38 * mm},
                    {'x' : 139.41 * mm, 'y' : 139.41 * mm},	{'x' : 110.25 * mm, 'y' : 163.44 * mm},
                    {'x' : 77.03 * mm, 'y' : 181.48 * mm},	{'x' : 40.99 * mm, 'y' : 192.84 * mm},
                    {'x' : 0.00 * mm, 'y' : 197.15 * mm},	{'x' : -37.62 * mm, 'y' : 193.53 * mm},
                    {'x' : -73.85 * mm, 'y' : 182.79 * mm},	{'x' : -107.38 * mm, 'y' : 165.34 * mm},
                    {'x' : -139.41 * mm, 'y' : 139.41 * mm},	{'x' : -163.44 * mm, 'y' : 110.25 * mm},
                    {'x' : -181.48 * mm, 'y' : 77.03 * mm},	{'x' : -192.84 * mm, 'y' : 40.99 * mm},
                    {'x' : -197.15 * mm, 'y' : 0.00 * mm},	{'x' : -193.53 * mm, 'y' : -37.62 * mm},
                    {'x' : -182.79 * mm, 'y' : -73.85 * mm},	{'x' : -165.34 * mm, 'y' : -107.38 * mm},
                    {'x' : -139.41 * mm, 'y' : -139.41 * mm},	{'x' : -110.25 * mm, 'y' : -163.44 * mm},
                    {'x' : -77.03 * mm, 'y' : -181.48 * mm},	{'x' : -40.99 * mm, 'y' : -192.84 * mm},
                    {'x' : 0.00 * mm, 'y' : -197.15 * mm},	{'x' : 37.62 * mm, 'y' : -193.53 * mm},
                    {'x' : 73.85 * mm, 'y' : -182.79 * mm},	{'x' : 107.38 * mm, 'y' : -165.34 * mm},
                    {'x' : 139.41 * mm, 'y' : -139.41 * mm},	{'x' : 163.44 * mm, 'y' : -110.25 * mm},
                    {'x' : 181.48 * mm, 'y' : -77.03 * mm},	{'x' : 192.84 * mm, 'y' : -40.99 * mm},
                    ]


# PMT gains
# Extracted from Zurich's Xenon100 PMT gain database using examples/extract_gain
# File used: all120326_1544.gain
# A few of these gains are zero: we'll assume these PMTs are turned off.
# PMT 0 does not exist (real Xenon100 PMTs start from 0), so it gets gain 0.
gains = [
             # 0   -- PMT zero is fake!
               0,
             # 1               # 2               # 3               # 4               # 5
       2675000.0,        2958000.0,        1936000.0,        2326000.0,        1964000.0,
             # 6               # 7               # 8               # 9              # 10
       1971000.0,        2104000.0,        1999000.0,              0.0,        2102000.0,
            # 11              # 12              # 13              # 14              # 15
       2044000.0,              0.0,        2177000.0,        2180000.0,        2265000.0,
            # 16              # 17              # 18              # 19              # 20
       2293000.0,        2177000.0,        2331000.0,        2099000.0,        2096000.0,
            # 21              # 22              # 23              # 24              # 25
       1899000.0,        2111000.0,        1874000.0,        1948000.0,        2106000.0,
            # 26              # 27              # 28              # 29              # 30
       2121000.0,        1987000.0,        1889000.0,        2473000.0,        2161000.0,
            # 31              # 32              # 33              # 34              # 35
       2192000.0,        2329000.0,        1112000.0,        2157000.0,        2106000.0,
            # 36              # 37              # 38              # 39              # 40
       2182000.0,        2001000.0,        1921000.0,              0.0,        2121000.0,
            # 41              # 42              # 43              # 44              # 45
       1852000.0,        1878000.0,        2088000.0,        1974000.0,        1940000.0,
            # 46              # 47              # 48              # 49              # 50
       2134000.0,        2132000.0,        2018000.0,        2207000.0,        2237000.0,
            # 51              # 52              # 53              # 54              # 55
       2201000.0,        1985000.0,        2173000.0,        2126000.0,        2288000.0,
            # 56              # 57              # 58              # 59              # 60
       2140000.0,        2170000.0,              0.0,        2408000.0,        2253000.0,
            # 61              # 62              # 63              # 64              # 65
       2109000.0,        2134000.0,        1979000.0,        2267000.0,        2149000.0,
            # 66              # 67              # 68              # 69              # 70
       2164000.0,        2077000.0,        2170000.0,        2223000.0,        2325000.0,
            # 71              # 72              # 73              # 74              # 75
       2122000.0,        2343000.0,        2312000.0,        2090000.0,        1944000.0,
            # 76              # 77              # 78              # 79              # 80
       2091000.0,        1948000.0,        1974000.0,        2098000.0,        2134000.0,
            # 81              # 82              # 83              # 84              # 85
       2184000.0,        1992000.0,        2150000.0,        1980000.0,        1878000.0,
            # 86              # 87              # 88              # 89              # 90
       2093000.0,        2162000.0,        1901000.0,        2120000.0,        2059000.0,
            # 91              # 92              # 93              # 94              # 95
       2281000.0,        2214000.0,        2143000.0,        1943000.0,        1934000.0,
            # 96              # 97              # 98              # 99             # 100
       2410000.0,        2227000.0,        1843000.0,        1881000.0,              0.0,
           # 101             # 102             # 103             # 104             # 105
       1965000.0,        2368000.0,        1938000.0,        1981000.0,              0.0,
           # 106             # 107             # 108             # 109             # 110
       1732000.0,        2091000.0,        1932000.0,        2080000.0,        2145000.0,
           # 111             # 112             # 113             # 114             # 115
       1932000.0,        1806000.0,        1939000.0,        1765000.0,        2111000.0,
           # 116             # 117             # 118             # 119             # 120
       2001000.0,        1917000.0,        2082000.0,        2043000.0,        2027000.0,
           # 121             # 122             # 123             # 124             # 125
       1833000.0,        1972000.0,        2030000.0,        2139000.0,        1946000.0,
           # 126             # 127             # 128             # 129             # 130
       1988000.0,        1967000.0,        2190000.0,        2217000.0,        2092000.0,
           # 131             # 132             # 133             # 134             # 135
       2252000.0,        2170000.0,        2014000.0,        1953000.0,        1997000.0,
           # 136             # 137             # 138             # 139             # 140
       1966000.0,        1854000.0,        2098000.0,        1639000.0,        2229000.0,
           # 141             # 142             # 143             # 144             # 145
       1759000.0,        1987000.0,        1911000.0,        1858000.0,        1653000.0,
           # 146             # 147             # 148             # 149             # 150
       2036000.0,        1716000.0,              0.0,        1907000.0,        2165000.0,
           # 151             # 152             # 153             # 154             # 155
       1833000.0,        2126000.0,        2119000.0,        1763000.0,        1990000.0,
           # 156             # 157             # 158             # 159             # 160
       1869000.0,        1874000.0,        2030000.0,        2152000.0,        1917000.0,
           # 161             # 162             # 163             # 164             # 165
       1749000.0,        1668000.0,        2085000.0,        1886000.0,        1692000.0,
           # 166             # 167             # 168             # 169             # 170
       2094000.0,        1446000.0,        1773000.0,        2023000.0,        1737000.0,
           # 171             # 172             # 173             # 174             # 175
       1859000.0,        1887000.0,        1872000.0,        2013000.0,        2078000.0,
           # 176             # 177             # 178             # 179             # 180
       1796000.0,              0.0,        1770000.0,        2018000.0,        2220000.0,
           # 181             # 182             # 183             # 184             # 185
       2544000.0,         978900.0,        1795000.0,        1445000.0,        1988000.0,
           # 186             # 187             # 188             # 189             # 190
       2032000.0,        1915000.0,        2143000.0,        2096000.0,              0.0,
           # 191             # 192             # 193             # 194             # 195
             0.0,        2081000.0,        1730000.0,        1637000.0,              0.0,
           # 196             # 197             # 198             # 199             # 200
       1936000.0,        1665000.0,        1958000.0,        1976000.0,        1975000.0,
           # 201             # 202             # 203             # 204             # 205
       1885000.0,        2101000.0,        2014000.0,        1997000.0,        2001000.0,
           # 206             # 207             # 208             # 209             # 210
       1993000.0,        1915000.0,        2113000.0,        1985000.0,        1813000.0,
           # 211             # 212             # 213             # 214             # 215
       2156000.0,        2041000.0,        2060000.0,        1890000.0,        2162000.0,
           # 216             # 217             # 218             # 219             # 220
       1810000.0,        1988000.0,        1983000.0,        1946000.0,        1941000.0,
           # 221             # 222             # 223             # 224             # 225
       2134000.0,        1829000.0,        1996000.0,              0.0,        1903000.0,
           # 226             # 227             # 228             # 229             # 230
       2096000.0,        2150000.0,        1990000.0,        1949000.0,        1870000.0,
           # 231             # 232             # 233             # 234             # 235
       2070000.0,        1946000.0,        1902000.0,        2128000.0,              0.0,
           # 236             # 237             # 238             # 239             # 240
       1946000.0,        1652000.0,        1986000.0,        1852000.0,        1909000.0,
           # 241             # 242
       1932000.0,        2013000.0,
    ]

# Sigmas of the 1pe peak in the gain spectrum, from same file
gain_sigmas = [
             # 0   -- PMT zero is fake!
               0,
             # 1               # 2               # 3               # 4               # 5
        931800.0,         891900.0,         786300.0,        1035000.0,         947800.0,
             # 6               # 7               # 8               # 9              # 10
        932700.0,        1167000.0,         976400.0,              0.0,        1154000.0,
            # 11              # 12              # 13              # 14              # 15
       1168000.0,              0.0,         956500.0,        1235000.0,        1250000.0,
            # 16              # 17              # 18              # 19              # 20
       1611000.0,        1203000.0,        1084000.0,        1333000.0,        1006000.0,
            # 21              # 22              # 23              # 24              # 25
       1051000.0,         935600.0,        1014000.0,        1281000.0,        1147000.0,
            # 26              # 27              # 28              # 29              # 30
        608800.0,         941200.0,         959700.0,        1464000.0,        1180000.0,
            # 31              # 32              # 33              # 34              # 35
       1186000.0,        1244000.0,         542500.0,        1146000.0,         951200.0,
            # 36              # 37              # 38              # 39              # 40
       1274000.0,        1075000.0,        1181000.0,              0.0,        1153000.0,
            # 41              # 42              # 43              # 44              # 45
        895700.0,         921500.0,        1106000.0,         997000.0,        1030000.0,
            # 46              # 47              # 48              # 49              # 50
       1116000.0,        1167000.0,        1112000.0,        1172000.0,        1327000.0,
            # 51              # 52              # 53              # 54              # 55
       1134000.0,         978500.0,        1070000.0,        1114000.0,        1229000.0,
            # 56              # 57              # 58              # 59              # 60
       1102000.0,        1065000.0,              0.0,        1193000.0,        1194000.0,
            # 61              # 62              # 63              # 64              # 65
       1142000.0,        1117000.0,        1079000.0,        1333000.0,        1079000.0,
            # 66              # 67              # 68              # 69              # 70
       1165000.0,        1080000.0,        1107000.0,        1293000.0,        1248000.0,
            # 71              # 72              # 73              # 74              # 75
       1303000.0,        1227000.0,        1224000.0,        1048000.0,         930300.0,
            # 76              # 77              # 78              # 79              # 80
       1351000.0,        1056000.0,         997500.0,        1203000.0,        1210000.0,
            # 81              # 82              # 83              # 84              # 85
       1033000.0,        1050000.0,        1300000.0,        1042000.0,        1110000.0,
            # 86              # 87              # 88              # 89              # 90
       1106000.0,        1326000.0,        1185000.0,        1261000.0,        1136000.0,
            # 91              # 92              # 93              # 94              # 95
       1212000.0,        1210000.0,        1281000.0,        1270000.0,        1141000.0,
            # 96              # 97              # 98              # 99             # 100
       1374000.0,        1220000.0,         993000.0,        1221000.0,              0.0,
           # 101             # 102             # 103             # 104             # 105
       1010000.0,        1248000.0,         924900.0,         975400.0,              0.0,
           # 106             # 107             # 108             # 109             # 110
        908800.0,        1026000.0,        1039000.0,         985600.0,        1290000.0,
           # 111             # 112             # 113             # 114             # 115
       1271000.0,        1054000.0,         941500.0,         988600.0,        1087000.0,
           # 116             # 117             # 118             # 119             # 120
       1030000.0,         880400.0,         870500.0,         991400.0,         899400.0,
           # 121             # 122             # 123             # 124             # 125
        878000.0,         991800.0,        1090000.0,        1113000.0,         936000.0,
           # 126             # 127             # 128             # 129             # 130
        957700.0,         940200.0,        1219000.0,        1326000.0,        1234000.0,
           # 131             # 132             # 133             # 134             # 135
       1212000.0,        1184000.0,         974400.0,         942600.0,         929500.0,
           # 136             # 137             # 138             # 139             # 140
       1023000.0,        1037000.0,         950000.0,        1064000.0,        1151000.0,
           # 141             # 142             # 143             # 144             # 145
        881900.0,         960500.0,         879600.0,         907300.0,         948400.0,
           # 146             # 147             # 148             # 149             # 150
        834400.0,         966800.0,              0.0,         926600.0,         906700.0,
           # 151             # 152             # 153             # 154             # 155
        872100.0,         859100.0,         976100.0,         747200.0,         839000.0,
           # 156             # 157             # 158             # 159             # 160
        943700.0,        1224000.0,        1071000.0,        1123000.0,         814200.0,
           # 161             # 162             # 163             # 164             # 165
        888900.0,        1000000.0,         991900.0,         873800.0,         917900.0,
           # 166             # 167             # 168             # 169             # 170
        875000.0,         736700.0,        1083000.0,         822400.0,        1020000.0,
           # 171             # 172             # 173             # 174             # 175
       1088000.0,        1069000.0,         863000.0,         925700.0,         939000.0,
           # 176             # 177             # 178             # 179             # 180
       1114000.0,              0.0,         927100.0,         851500.0,         920800.0,
           # 181             # 182             # 183             # 184             # 185
       1285000.0,         874700.0,        1045000.0,         746600.0,        1415000.0,
           # 186             # 187             # 188             # 189             # 190
        895900.0,        1191000.0,         982100.0,         900900.0,              0.0,
           # 191             # 192             # 193             # 194             # 195
             0.0,        1268000.0,        1362000.0,        1308000.0,              0.0,
           # 196             # 197             # 198             # 199             # 200
       1287000.0,        1156000.0,        1169000.0,        1411000.0,        1127000.0,
           # 201             # 202             # 203             # 204             # 205
        876800.0,        1350000.0,        1131000.0,        1249000.0,        1477000.0,
           # 206             # 207             # 208             # 209             # 210
       1218000.0,        1122000.0,        1093000.0,        1275000.0,         894900.0,
           # 211             # 212             # 213             # 214             # 215
        928500.0,        1045000.0,        1009000.0,         894700.0,         885000.0,
           # 216             # 217             # 218             # 219             # 220
        947500.0,         991300.0,        1087000.0,        1160000.0,        1138000.0,
           # 221             # 222             # 223             # 224             # 225
       1124000.0,        1156000.0,        1090000.0,              0.0,         944000.0,
           # 226             # 227             # 228             # 229             # 230
       1113000.0,        1335000.0,        1182000.0,         983200.0,        1153000.0,
           # 231             # 232             # 233             # 234             # 235
       1335000.0,        1344000.0,        1103000.0,        1288000.0,              0.0,
           # 236             # 237             # 238             # 239             # 240
       1173000.0,        1226000.0,         942800.0,        1117000.0,        1182000.0,
           # 241             # 242
       1042000.0,        1096000.0,
    ]
